"use strict";!function i(r,s,d){function c(e,t){if(!s[e]){if(!r[e]){var o="function"==typeof require&&require;if(!t&&o)return o(e,!0);if(l)return l(e,!0);var a=new Error("Cannot find module '"+e+"'");throw a.code="MODULE_NOT_FOUND",a}var n=s[e]={exports:{}};r[e][0].call(n.exports,function(t){return c(r[e][1][t]||t)},n,n.exports,i,r,s,d)}return s[e].exports}for(var l="function"==typeof require&&require,t=0;t<d.length;t++)c(d[t]);return c}({1:[function(t,e,o){e.exports='<div class="backtotop__record"><div class="backtotop__record-head clear"><div class="backtotop__record-head__running backtotop__record-head__tab js-record-tab {{#runningShow}}active{{/runningShow}} " href="#running"> 进行中</div><div class="backtotop__record-head__done backtotop__record-head__tab js-record-tab {{#doneShow}}active{{/doneShow}}" href="#done">已完成</div><div class="backtotop__record-head__close"></div></div><div class="backtotop__record-body"><div id="running" class="backtotop__record-body__running {{#runningShow}}active{{/runningShow}} js-record"><ul> {{#running}}<li class="clear running__li"><div class="running__left backtotop__body-left"><div class="backtotop__body-name-container clear"> <span class="backtotop__body-type {{typeClass}} huice">{{typeName}}</span> <a href="{{href}}" class="backtotop__body-name">{{name}}</a><span class="backtotop__body-runningCircle"></span></div></div><div class="running__right backtotop__body-right {{statusClass}}" data-type={{typeId}} data-id={{id}}></div></li> {{/running}} {{^running}}<li class="no-data">没有发现项目～</li> {{/running}}</ul></div><div id="done" class="backtotop__record-body__done {{#doneShow}}active{{/doneShow}} js-record"><ul> {{#done}}<li class="clear"><div class="done__left backtotop__body-left"><div class="backtotop__body-name-container clear"> <span class="backtotop__body-type {{typeClass}}">{{typeName}}</span> <a href="{{href}}" class="backtotop__body-name">{{name}}</a></div></div><div class="done__right backtotop__body-right {{statusClass}}"></div></li> {{/done}} {{^done}}<li class="no-data">没有发现项目～</li> {{/done}}</ul></div></div></div>'},{}],2:[function(t,e,o){e.exports='<li class="qiyukf__entry {{#qiyukfHidden}}hidden{{/qiyukfHidden}}" onclick="ysf(\'open\')"></li><li class="backtotop__progress {{#hidden}}hidden{{/hidden}}"><span class="backtotop__progress-count hidden"></span><div class="backtotop__record-container hidden"></div></li><li class="newUser backtotop__newUser hidden backtotop__scroll"><a href="/post/24debe6786302edc2febfc09b1312a6c" target="_blank"></a></li><li class="toTop backtotop__toTop hidden backtotop__scroll" id="top_btn"></li>'},{}],3:[function(S,t,e){t.exports=function(o,t){var n,e=S("@util/routeParam.component")().isMobile();n=S("jquery"),e||(o=o||window);function a(){document[b.hiddenProperty]?b.currentHtml=!1:(b.currentHtml=!0,v())}function i(t){t=t||o.event;var e=n(t.target);(e.hasClass("backtotop__progress")||e.hasClass("backtotop__record-head__close"))&&(n(".backtotop__record-container").toggleClass("hidden"),b.stopInitRecord=!b.stopInitRecord,clearTimeout(b.initRecordTime),v())}function r(t){t=t||o.event;var e=n(t.target);e.hasClass("backtotop__progress")||e.parents(".backtotop__progress").get(0)||n(".backtotop__record-container").hasClass("hidden")||(n(".backtotop__record-container").addClass("hidden"),b.stopInitRecord=!b.stopInitRecord,clearTimeout(b.initRecordTime),v())}function s(){var t=n(".js-record-tab"),e=n(".js-record"),o=n(this),a=n(o.attr("href"));t.removeClass("active"),e.removeClass("active"),o.addClass("active"),a.addClass("active"),"#done"===o.attr("href")?(b.doneShow=!0,b.runningShow=!1):(b.doneShow=!1,b.runningShow=!0)}function d(){var t=n(this),e=t.attr("data-type"),o=t.attr("data-id"),a={};if(a[e]=o,t.hasClass("disabled"))return!1;t.addClass("disabled"),p.promise(y[e],a,"POST").done(function(t){clearTimeout(b.initRecordTime),v()},function(t){f().createDialog({title:"提示",dialogCss:"backtotop__dialog",domHtml:t.msg,submitBtnText:"确定",cancelBtnCss:"hidden"})})}function c(){"off"!=scroll&&n("html, body").animate({scrollTop:0},300)}function l(){if(-1!==window.location.href.indexOf("newwinapp"))return!1;!function(){var t="hidden"in document?"hidden":"webkitHidden"in document?"webkitHidden":"mozHidden"in document?"mozHidden":null,e=t.replace(/hidden/i,"visibilitychange");b.hiddenProperty=t,b.visibilityChangeEvent=e}(),function(){if(window.userInfo)return;window.userInfo=!0,o.location.href.indexOf(["/algorithm/backtest/summary","/default/research/detail"])<0&&n.ajax({url:"/community/post/userInfo",success:function(t){var e=(t=JSON.parse(t)).data;"00000"===t.code&&(o.ysf&&o.ysf("config",{uid:e.uniqueKey,name:e.alias}),Array.isArray(t.data)||(b.isLogin=!0,window.loginStatus=!0))},error:function(t){}})}(),setTimeout(function(){b.isLogin=window.loginStatus,I(),T(),m=_.render(m,b),u.find("#leftsead ul").prepend(m),v(),C(),x()},100)}var u=n(t),p=S("@util/http.component")(),h=S("@util/render.component")(),f=S("@component/dialog/dialog.component"),_=S("mustache"),m=S("./index.component.html"),g=S("./asset/tpl/operation.record.html"),b={cdnPath:n(".js-cdn-path").val(),isLogin:!1,runningShow:!0,doneShow:!1,stopInitRecord:!1,currentHtml:!0,hideProgress:!1},y={statistics:"/algorithm/index/statistics",backtestId:"/algorithm/index/cancel",analyBacktestId:"/algorithm/backtest/analyCancel",factorAnalyId:"/algorithm/factorAnaly/cancel",url:{backtest:"/algorithm/backtest/detail?backtestId=",guiyin:"/algorithm/backtest/attributionAnaly?backtestId=",yinzi:"/algorithm/factorAnaly/detail?factorAnalyId="},getMessage:"/credits/index/getMessage"},v=function t(){if(b.isLogin&&!e){if(!b.currentHtml||b.hideProgress)return!1;p.promise(y.statistics).done(function(t){var e=t.data;for(var o in e.running.length?u.find(".backtotop__progress-count").removeClass("hidden").html(e.running.length):u.find(".backtotop__progress-count").addClass("hidden").html(""),e.runningShow=b.runningShow,e.doneShow=b.doneShow,e)e[o].length&&e[o].map(function(t,e){"0"===t.type?(t.typeId="backtestId",t.typeName="回测",t.typeClass="huice",t.href=y.url.backtest+t.id):"1"===t.type?(t.typeName="归因",t.typeClass="guiyin",t.typeId="analyBacktestId",t.href=y.url.guiyin+t.id):"2"===t.type&&(t.typeId="factorAnalyId",t.typeName="因子",t.typeClass="yinzi",t.href=y.url.yinzi+t.id),"2"===t.status?(t.statusClass="success",t.progressbarClass="progress-bar-success"):"3"===t.status||"4"===t.status?(t.statusClass="fail",t.progressbarClass="progress-bar-danger"):(t.progressbarClass="progress-bar-success",t.statusClass="cancel")});k(),h(u.find(".backtotop__record-container"),g,e),w()})}b.currentHtml&&(b.stopInitRecord?b.initRecordTime=setTimeout(t,3e3):b.initRecordTime=setTimeout(t,3e4))},k=function(){b.scrollT=n(".backtotop__record-body").scrollTop()},w=function(){n(".backtotop__record-body").scrollTop(b.scrollT)},C=function(){var t=n(o).scrollTop();e?n("#leftsead").addClass("hidden"):200<=t?n("#leftsead").find(".backtotop__scroll").removeClass("hidden"):n("#leftsead").find(".backtotop__scroll").addClass("hidden")},I=function(){["/algorithm/index/edit","/factor/factor/edit","/view/algorithm/fundraising","/algorithm/backtest/summary","/default/research/detail","/help/data/tableList","/help/data/dataTree"].forEach(function(t){-1!==o.location.href.indexOf(t)&&(b.qiyukfHidden=!0)})},T=function(){["/algorithm/backtest/summary","/default/research/detail","/algorithm/index/edit","/algorithm/factor/edit","algorithm/live/liveUrlShareIndex","/help/data/dataTree","/help/data/tableList"].map(function(t,e){0<=o.location.href.indexOf(t)&&(b.hideProgress=!0)}),["/algorithm/backtest/summary","/default/research/detail"].map(function(t,e){0<=o.location.href.indexOf(t)&&(b.iframeMessage=!0)}),b.isLogin&&!b.hideProgress||(b.hidden=!0),b.isLogin&&!b.iframeMessage||(b.iframeHidden=!0)},x=function(){b.isLogin&&p.promise(y.getMessage).done(function(t){if(!b.iframeHidden){if(t.data){var e=parseInt(t.data.credits.amount)<0?"cut-amount":"add-amount",o=parseInt(t.data.credits.amount)<0?t.data.credits.amount:"+"+t.data.credits.amount;n("#leftsead > ul").prepend('<li class="leftsead-message"> <div>'+t.data.credits.message+' 积分<span class="'+e+'">'+o+"</span></div> </li>")}setTimeout(function(){n("#leftsead").find(".leftsead-message").remove()},2e3)}})};return{init:function(){l(),u.delegate(".backtotop__progress","click",i),u.delegate(".kk_body","click",r),u.delegate(".js-record-tab","click",s),u.delegate(".running__right.cancel","click",d),u.delegate("#top_btn","click",c),n(o).scroll(C),document.addEventListener(b.visibilityChangeEvent,a)}}}},{"./asset/tpl/operation.record.html":1,"./index.component.html":2,"@component/dialog/dialog.component":void 0,"@util/http.component":void 0,"@util/render.component":void 0,"@util/routeParam.component":void 0,jquery:"jquery",mustache:"mustache"}],4:[function(t,e,o){t("./index.component")(window,document.body).init()},{"./index.component":3}]},{},[4]);